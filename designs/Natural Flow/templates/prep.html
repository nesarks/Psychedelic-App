<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Natural Flow - Preparation</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/static/styles.css">
  <style>
    .prep-flow {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      padding: 2rem 0;
      position: relative;
      overflow-x: hidden;
    }
    
    .prep-header {
      text-align: center;
      margin-bottom: 2rem;
    }
    
    .prep-container {
      max-width: 800px;
      margin: 0 auto;
      width: 100%;
    }
    
    .progress-bar {
      width: 100%;
      height: 8px;
      background-color: var(--dark-sand);
      border-radius: 4px;
      margin-bottom: 2rem;
      overflow: hidden;
    }
    
    .progress-bar-fill {
      height: 100%;
      background-color: var(--moss);
      border-radius: 4px;
      transition: width 0.5s ease;
      width: 0%;
    }
    
    .prep-steps {
      position: relative;
      min-height: 60vh;
    }
    
    .prep-step {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      opacity: 0;
      pointer-events: none;
      transition: all 0.5s ease;
      transform: translateX(50px);
    }
    
    .prep-step.active {
      opacity: 1;
      pointer-events: all;
      transform: translateX(0);
    }
    
    .prep-step.slide-out {
      transform: translateX(-50px);
      opacity: 0;
    }
    
    .prep-step.slide-out-right {
      transform: translateX(50px);
      opacity: 0;
    }
    
    .prep-step.slide-in {
      animation: slideIn 0.5s forwards;
    }
    
    .prep-step.slide-in-left {
      animation: slideInFromLeft 0.5s forwards;
    }
    
    @keyframes slideIn {
      from {
        transform: translateX(50px);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }
    
    @keyframes slideInFromLeft {
      from {
        transform: translateX(-50px);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }
    
    .step-content {
      background-color: white;
      border-radius: 20px;
      padding: 2rem;
      box-shadow: 0 8px 16px rgba(0,0,0,0.1);
    }
    
    .step-title {
      font-size: 1.8rem;
      color: var(--dark-moss);
      margin-bottom: 1.5rem;
    }
    
    .form-group {
      margin-bottom: 1.5rem;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
    }
    
    .form-control {
      width: 100%;
      padding: 1rem;
      font-size: 1rem;
      border: 2px solid var(--dark-sand);
      border-radius: 10px;
      background-color: var(--sand);
      transition: all 0.3s ease;
    }
    
    .form-control:focus {
      outline: none;
      border-color: var(--river);
      box-shadow: 0 0 0 2px rgba(165, 188, 194, 0.3);
    }
    
    textarea.form-control {
      min-height: 120px;
      resize: vertical;
    }
    
    .mood-selector {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin: 1rem 0;
    }
    
    .mood-option {
      background-color: var(--sand);
      border: 2px solid transparent;
      border-radius: 50px;
      padding: 0.8rem 1.5rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .mood-option:hover {
      background-color: var(--dark-sand);
    }
    
    .mood-option.selected {
      background-color: var(--moss);
      color: white;
    }
    
    .step-actions {
      display: flex;
      justify-content: space-between;
      margin-top: 2rem;
    }
    
    .radio-group {
      display: flex;
      gap: 1.5rem;
      margin: 1rem 0;
    }
    
    .radio-option {
      display: flex;
      align-items: center;
    }
    
    .radio-option input {
      margin-right: 0.5rem;
    }
    
    .context-help {
      background-color: var(--sand);
      border-radius: 10px;
      padding: 1rem;
      margin: 1rem 0;
      font-size: 0.9rem;
    }
    
    .context-help h4 {
      margin-bottom: 0.5rem;
      color: var(--dark-moss);
    }
  </style>
</head>
<body>
  <div class="prep-flow">
    <div class="background-ripple-container"></div>
    
    <div class="prep-container">
      <div class="prep-header">
        <h1>Prepare for Your Journey</h1>
        <p>Let's set the right conditions for a meaningful experience</p>
      </div>
      
      <div class="progress-bar">
        <div class="progress-bar-fill"></div>
      </div>
      
      <form class="prep-form">
        <div class="prep-steps">
          <!-- Step 1: Intention Setting -->
          <div class="prep-step active">
            <div class="step-content">
              <h2 class="step-title">1. Set Your Intention</h2>
              
              <div class="form-group">
                <label for="intention">What is your intention for this journey?</label>
                <textarea class="form-control" id="intention" name="intention" placeholder="I am approaching this experience with the intention to..."></textarea>
              </div>
              
              <div class="context-help">
                <h4>Guidance</h4>
                <p>Setting a clear intention helps direct your experience. Focus on growth, healing, or understanding rather than specific outcomes.</p>
              </div>
              
              <div class="step-actions">
                <div></div> <!-- Empty div for spacing -->
                <button type="button" class="btn next-step">Continue</button>
              </div>
            </div>
          </div>
          
          <!-- Step 2: Current Mindset -->
          <div class="prep-step">
            <div class="step-content">
              <h2 class="step-title">2. Check In With Yourself</h2>
              
              <div class="form-group">
                <label>How are you feeling right now?</label>
                <div class="mood-selector">
                  <div class="mood-option" data-mood="calm">Calm</div>
                  <div class="mood-option" data-mood="anxious">Anxious</div>
                  <div class="mood-option" data-mood="curious">Curious</div>
                  <div class="mood-option" data-mood="excited">Excited</div>
                  <div class="mood-option" data-mood="apprehensive">Apprehensive</div>
                  <div class="mood-option" data-mood="open">Open</div>
                </div>
                <input type="hidden" name="mood" id="mood-input">
              </div>
              
              <div class="form-group">
                <label for="concerns">Do you have any specific concerns or questions?</label>
                <textarea class="form-control" id="concerns" name="concerns" placeholder="I'm wondering about..."></textarea>
              </div>
              
              <div class="step-actions">
                <button type="button" class="btn btn-secondary prev-step">Back</button>
                <button type="button" class="btn next-step">Continue</button>
              </div>
            </div>
          </div>
          
          <!-- Step 3: Environment -->
          <div class="prep-step">
            <div class="step-content">
              <h2 class="step-title">3. Prepare Your Space</h2>
              
              <div class="form-group">
                <label>Is your environment comfortable and safe?</label>
                <div class="radio-group">
                  <div class="radio-option">
                    <input type="radio" id="environment-yes" name="environment_ready" value="yes" checked>
                    <label for="environment-yes">Yes</label>
                  </div>
                  <div class="radio-option">
                    <input type="radio" id="environment-no" name="environment_ready" value="no">
                    <label for="environment-no">Not yet</label>
                  </div>
                </div>
              </div>
              
              <div class="context-help">
                <h4>Environment Checklist</h4>
                <ul>
                  <li>Comfortable seating or lying space</li>
                  <li>Water easily accessible</li>
                  <li>Minimal distractions (phone on silent)</li>
                  <li>Dim lighting or eye mask available</li>
                  <li>Comfortable temperature</li>
                </ul>
              </div>
              
              <div class="form-group">
                <label for="environment-notes">Anything you want to note about your space?</label>
                <input type="text" class="form-control" id="environment-notes" name="environment_notes">
              </div>
              
              <div class="step-actions">
                <button type="button" class="btn btn-secondary prev-step">Back</button>
                <button type="button" class="btn next-step">Continue</button>
              </div>
            </div>
          </div>
          
          <!-- Step 4: Support and Safety -->
          <div class="prep-step">
            <div class="step-content">
              <h2 class="step-title">4. Support Systems</h2>
              
              <div class="form-group">
                <label>Do you have someone who knows you're journeying today?</label>
                <div class="radio-group">
                  <div class="radio-option">
                    <input type="radio" id="support-yes" name="support_person" value="yes">
                    <label for="support-yes">Yes</label>
                  </div>
                  <div class="radio-option">
                    <input type="radio" id="support-no" name="support_person" value="no" checked>
                    <label for="support-no">No</label>
                  </div>
                </div>
              </div>
              
              <div class="context-help">
                <h4>Safety Note</h4>
                <p>While not always necessary, having someone who knows what you're doing can provide peace of mind. Remember the safety bubble is always available during your journey.</p>
              </div>
              
              <div class="form-group">
                <label for="comfort-item">What's one thing that brings you comfort?</label>
                <input type="text" class="form-control" id="comfort-item" name="comfort_item" placeholder="A favorite blanket, a specific song, etc.">
              </div>
              
              <div class="step-actions">
                <button type="button" class="btn btn-secondary prev-step">Back</button>
                <button type="button" class="btn next-step">Continue</button>
              </div>
            </div>
          </div>
          
          <!-- Step 5: Final Preparation -->
          <div class="prep-step">
            <div class="step-content">
              <h2 class="step-title">5. Ready to Begin</h2>
              
              <p>You've completed all preparation steps. Take a moment to center yourself before beginning your journey.</p>
              
              <div class="form-group">
                <label>Set timer duration (optional)</label>
                <select class="form-control" name="timer_duration">
                  <option value="none">No timer</option>
                  <option value="30">30 minutes</option>
                  <option value="60">1 hour</option>
                  <option value="90">1.5 hours</option>
                  <option value="120">2 hours</option>
                  <option value="180">3 hours</option>
                </select>
              </div>
              
              <div class="context-help">
                <h4>Final Reminders</h4>
                <ul>
                  <li>Natural Flow will be with you throughout</li>
                  <li>The safety bubble is always available</li>
                  <li>Trust the process and your own wisdom</li>
                  <li>You can end the session at any time</li>
                </ul>
              </div>
              
              <div class="step-actions">
                <button type="button" class="btn btn-secondary prev-step">Back</button>
                <button type="button" class="btn submit-prep">Begin Journey</button>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
    
    <!-- Safety Bubble (persistent across all pages) -->
    <div class="safety-bubble">
      <div class="safety-button">
        <img src="/static/images/heart.svg" alt="Safety">
      </div>
      
      <div class="safety-popup">
        <h3>Are you okay?</h3>
        <p>Take a deep breath. Remember you are safe and this experience is temporary.</p>
        
        <div class="comfort-anchors">
          <div class="anchor-item" id="anchor-image">
            <img src="/static/images/calm-nature.jpg" alt="Calm image">
          </div>
          <div class="anchor-item" id="anchor-mantra">
            <p>"I am safe in this moment"</p>
          </div>
          <div class="anchor-item" id="anchor-quote">
            <p>"The only way out is through"</p>
          </div>
          <div class="anchor-item" id="anchor-breath">
            <p>Breathe with me</p>
          </div>
        </div>
        
        <button class="btn close-btn">I'm Okay</button>
        <button class="btn btn-secondary emergency-hide-btn">Hide Screen</button>
      </div>
    </div>
  </div>
  
  <script src="/static/main.js"></script>
  <script>
    // Additional prep flow JavaScript
    document.addEventListener('DOMContentLoaded', () => {
      // Mood selector functionality
      const moodOptions = document.querySelectorAll('.mood-option');
      const moodInput = document.getElementById('mood-input');
      
      moodOptions.forEach(option => {
        option.addEventListener('click', () => {
          // Remove selected class from all options
          moodOptions.forEach(opt => opt.classList.remove('selected'));
          
          // Add selected class to clicked option
          option.classList.add('selected');
          
          // Update hidden input value
          moodInput.value = option.dataset.mood;
        });
      });
    });
  </script>
</body>
</html>